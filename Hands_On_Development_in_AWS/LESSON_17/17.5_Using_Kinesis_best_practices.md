# 17.5 Using Kinesis best practices 
 
- **Use Shard-Level Metrics**
  - Monitor shard-level metrics to ensure data is being processed correctly
  - Provides visibility into how well each shard is handling traffic
  - Metrics are available in **Amazon CloudWatch**

- **Monitor IteratorAge**
  - Indicates how far behind consumers are from the latest data
  - If IteratorAge exceeds the configured retention period:
    - Records expire
    - Data is permanently lost

- **Watch ReadProvisionedThroughputExceeded**
  - Occurs when read throughput exceeds provisioned capacity
  - Can result in throttling
  - May lead to data processing delays or loss

- **Understand Poison Messages**
  - A poison message is a record that fails processing
  - If one record in a batch fails:
    - The entire batch may fail
    - Successfully processed records may be reprocessed
    - Can result in **duplicate data**, such as duplicate database entries

- **Handling Poison Messages – Solution 1**
  - Implement logic in Lambda to:
    - Log the failure
    - Mark the record as failed
    - Return success for the batch
  - Prevents reprocessing of successful records

- **Handling Poison Messages – Solution 2**
  - Implement retry and failure handling
  - Split the batch on error
  - Retry with smaller batches
  - Continue narrowing until the problematic record is isolated

- **Key Takeaway**
  - Proper monitoring and error-handling logic are critical for reliable Kinesis processing
  - Best practices help prevent data loss, throttling, and duplicate processing

 
 ## [Context](./../context.md)